<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <title>Menu Qu√°n ƒÇn (Noodle Modal Update)</title>
    <style>
        /* === Bi·∫øn CSS v√† Reset === */
        :root {
             --font-family-base: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --primary-color: #0073e6;
            --primary-darker: #0052b3;
            --success-color: #249c3f;
            --success-darker: #1e7e34;
            --danger-color: #dc3545;
            --danger-darker: #c82333;
            --warning-light-bg: #fff0c1;
            --warning-light-text: #594200;
            --warning-light-hover: #ffe69c;
            --warning-border-color: #ffda6a;
            --light-gray: #f8f9fa;
            --medium-gray: #dee2e6;
            --dark-gray: #495057;
            --text-color: #343a40;
            --card-bg: #ffffff;
            --card-border-color: #e9ecef;
            --card-shadow: 0 3px 8px rgba(0,0,0,0.05);
            --card-hover-shadow: 0 5px 12px rgba(0,0,0,0.08);
            --border-radius: 10px;
            --spacing-unit: 16px;
            --modal-overlay-bg: rgba(0, 0, 0, 0.6);
            --float-button-bg: var(--primary-color);
            --float-button-text: white;
            --float-button-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            --float-button-hover-bg: var(--primary-darker);
            --category-title-bg: #198754;
            --category-title-text: white;
        }
        *, *::before, *::after { box-sizing: border-box; }
        body { font-family: var(--font-family-base); line-height: 1.6; margin: 0; background-color: var(--light-gray); color: var(--text-color); position: relative; }
        body.modal-open { overflow: hidden; }
        .container { max-width: 1200px; margin: auto; padding: calc(var(--spacing-unit) * 1.5); }

        .container > h1 { text-align: center; font-weight: 700; margin-bottom: calc(var(--spacing-unit) * 2); font-size: 2.2em; }
        h2 { font-weight: 600; color: var(--dark-gray); border-bottom: 1px solid var(--medium-gray); padding-bottom: calc(var(--spacing-unit) * 0.6); margin-bottom: calc(var(--spacing-unit) * 1.5); font-size: 1.6em; }
        #menu-section > h2, #order-section > h2 { text-align: center; border-bottom: none; margin-bottom: var(--spacing-unit); }
        h3 { margin: 0; padding: 0; font-size: 1.05em; line-height: 1.4; font-weight: normal; }
        h4 { font-size: 1.4em; font-weight: 600; margin-top: 0; margin-bottom: calc(var(--spacing-unit)*0.8); }
        .menu-order-container { display: flex; flex-wrap: wrap; gap: calc(var(--spacing-unit) * 2); }
        #menu-section { flex: 2; min-width: 250px; }
        #order-section { flex: 1; min-width: 320px; background-color: var(--card-bg); padding: var(--spacing-unit); border-radius: var(--border-radius); box-shadow: var(--card-shadow); align-self: flex-start; position: sticky; top: 20px; border: 1px solid var(--card-border-color); }
        #menu { width: 100%; }
        .menu-category-title { font-size: 1.3em; font-weight: 600; line-height: 1.5; text-align: center; color: var(--category-title-text); padding: calc(var(--spacing-unit) * 0.8) var(--spacing-unit); background-color: var(--category-title-bg); border-radius: var(--border-radius); box-shadow: 0 2px 5px rgba(25, 135, 84, 0.3); border-bottom: none; margin-top: calc(var(--spacing-unit) * 2.5); margin-bottom: calc(var(--spacing-unit) * 1.5); }
        .menu-category-title:first-of-type { margin-top: 0; }
        .menu-category-items { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: var(--spacing-unit); margin-bottom: calc(var(--spacing-unit) * 1.5); }
        .menu-item-card { background-color: var(--card-bg); border-radius: var(--border-radius); box-shadow: var(--card-shadow); overflow: hidden; display: flex; flex-direction: column; border: 1px solid var(--card-border-color); transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out; position: relative; }
        .menu-item-card:hover { transform: translateY(-4px); box-shadow: var(--card-hover-shadow); }
        .menu-item-card img { width: 100%; height: 250px; object-fit: cover; display: block; border-bottom: 1px solid var(--card-border-color); background-color: #e9ecef; }
        .menu-item-info { padding: var(--spacing-unit); flex-grow: 1; display: flex; flex-direction: column; position: relative; }
        .menu-item-name-wrapper { margin-bottom: 5px; display: flex; align-items: flex-start; flex-wrap: wrap; }
        .menu-item-name-wrapper h3 { flex-grow: 1; margin-right: 5px; }
        .en-name { font-weight: 600; color: var(--text-color); margin-right: 0.4em; }
        .vn-name { font-weight: 400; font-size: 0.9em; color: var(--dark-gray); }
        .spicy-icon { margin-left: 5px; font-size: 0.9em; display: inline-block; vertical-align: middle; }
        .info-icon { display: inline-block; background: none; border: none; padding: 2px 5px; margin-left: auto; font-size: 0.75em; font-weight: 600; color: var(--primary-color); cursor: pointer; text-decoration: none; border-radius: 4px; transition: color 0.2s ease, text-decoration 0.2s ease, background-color 0.2s ease; flex-shrink: 0; align-self: center; }
        .info-icon:hover, .info-icon:focus-visible { color: var(--primary-darker); text-decoration: underline; background-color: #e7f1ff; }
        .info-icon:focus-visible { outline: 1px dotted var(--primary-color); outline-offset: 2px; }
        .menu-item-details { margin-top: 5px; }
        .menu-item-info .price { font-weight: 700; font-size: 1.15em; color: var(--primary-color); margin-bottom: calc(var(--spacing-unit) * 0.5); display: block; }
        .noodle-choice-indicator, .noodle-choice-explanation { font-size: 0.8em; font-style: italic; color: var(--dark-gray); display: block; }
        .noodle-choice-indicator { margin-bottom: 2px; margin-top: -5px; }
        .noodle-choice-explanation { margin-bottom: calc(var(--spacing-unit) * 0.8); font-size: 0.75em; font-style: normal; }
        .quantity-selector { display: flex; align-items: center; margin-bottom: var(--spacing-unit); }
        .quantity-selector button { width: 32px; height: 32px; padding: 0; font-size: 1.5em; line-height: 1; border: 1px solid var(--medium-gray); background-color: var(--light-gray); color: var(--dark-gray); cursor: pointer; border-radius: 5px; transition: background-color 0.15s ease, border-color 0.15s ease; }
        .quantity-selector button:hover { background-color: #e2e6ea; }
        .quantity-selector button:active { background-color: #d6dadf; }
        .quantity-selector button:focus-visible { outline: 2px solid var(--primary-color); outline-offset: 2px; border-color: var(--primary-color); }
        .quantity-selector input { width: 45px; height: 30px; text-align: center; border: 1px solid var(--medium-gray); margin: 0 6px; font-size: 1em; font-weight: 600; border-radius: 5px; -moz-appearance: textfield; appearance: textfield; }
        .quantity-selector input:focus-visible { outline: 2px solid var(--primary-color); outline-offset: 1px; border-color: var(--primary-color); }
        .quantity-selector input::-webkit-outer-spin-button, .quantity-selector input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        .add-to-order-button { width: 100%; padding: 12px; background-color: var(--success-color); color: white; border: 1px solid transparent; border-radius: 5px; cursor: pointer; font-size: 1em; font-weight: 600; margin-top: auto; transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease, transform 0.1s ease, opacity 0.2s ease; position: relative; z-index: 1; display: flex; align-items: center; justify-content: center; gap: 8px; }
        .add-to-order-button:hover { background-color: var(--success-darker); border-color: #1e7e34; }
        .add-to-order-button:active { background-color: #1e7e34; transform: scale(0.98); }
        .add-to-order-button:focus-visible { outline: 3px solid var(--success-color); outline-offset: 2px; }
        .add-to-order-button.item-in-order { background-color: var(--warning-light-bg); color: var(--warning-light-text); border-color: var(--warning-border-color); font-weight: 600; justify-content: space-between; padding-left: 15px; padding-right: 10px; }
        .add-to-order-button.item-in-order:hover { background-color: var(--warning-light-hover); border-color: #ffcf5a; }
        .add-to-order-button.item-in-order:active { background-color: #ffe085; transform: scale(0.98); }
        .add-to-order-button.item-in-order:focus-visible { outline: 3px solid var(--warning-light-hover); outline-offset: 2px; }
        .remove-from-menu { font-size: 1.3em; font-weight: bold; line-height: 1; color: var(--danger-color); cursor: pointer; padding: 2px 5px; border-radius: 50%; transition: background-color 0.15s ease, color 0.15s ease; }
        .remove-from-menu:hover { background-color: rgba(220, 53, 69, 0.1); color: var(--danger-darker); }
        .add-confirmation { position: absolute; bottom: 60px; left: 50%; transform: translateX(-50%) translateY(10px); background-color: rgba(36, 156, 63, 0.95); color: white; padding: 6px 12px; border-radius: 15px; font-size: 0.9em; font-weight: 600; opacity: 0; transition: opacity 0.4s ease-out, transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); pointer-events: none; z-index: 2; white-space: nowrap; }
        .add-confirmation.show { opacity: 1; transform: translateX(-50%) translateY(0); }
        #order-summary h2 { margin-top: 0; border-bottom: 1px solid var(--medium-gray); padding-bottom: var(--spacing-unit); margin-bottom: var(--spacing-unit); font-size: 1.3em; }
        #order-items { list-style: none; padding: 0; margin: 0 0 var(--spacing-unit) 0; border-bottom: 1px solid var(--card-border-color); padding-bottom: 10px; min-height: 80px; position: relative; }
        .order-empty-message { text-align: center; color: var(--dark-gray); padding: calc(var(--spacing-unit) * 2) var(--spacing-unit); font-style: italic; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: calc(100% - 30px); }
        #order-items li { display: flex; justify-content: space-between; align-items: center; padding: 12px 5px; border-bottom: 1px dotted var(--card-border-color); font-size: 0.95em; }
        #order-items li:last-child { border-bottom: none; }
        #order-items li span:first-child { flex-grow: 1; margin-right: 10px; line-height: 1.4; font-weight: 500; }
        #order-items li .order-qty-controls { display: flex; align-items: center; margin: 0 8px; }
        #order-items li .order-qty-controls button { width: 26px; height: 26px; padding: 0; font-size: 1.2em; line-height: 1; background-color: #f1f3f5; border: 1px solid var(--medium-gray); color: var(--dark-gray); border-radius: 4px; cursor: pointer; margin: 0 5px; transition: background-color 0.15s ease; }
        #order-items li .order-qty-controls button:hover { background-color: #e2e6ea; }
        #order-items li .order-qty-controls button:focus-visible { outline: 2px solid var(--primary-color); outline-offset: 1px; }
        #order-items li .order-qty-controls .quantity { min-width: 25px; text-align: center; font-weight: 600; font-size: 1.05em; }
        #order-items li .item-total-price { min-width: 85px; text-align: right; font-weight: 600; color: var(--dark-gray); margin: 0 8px; }
        #order-items li .remove-item { background-color: transparent; color: var(--danger-color); border: 1px solid transparent; width: 28px; height: 28px; padding: 0; font-size: 1.3em; font-weight: bold; line-height: 1; border-radius: 50%; cursor: pointer; transition: background-color 0.15s ease, color 0.15s ease, border-color 0.15s ease; display: flex; align-items: center; justify-content: center; }
        #order-items li .remove-item:hover { background-color: #fdf0f1; border-color: var(--danger-color); }
        #order-items li .remove-item:focus-visible { outline: 2px solid var(--danger-color); outline-offset: 1px; background-color: #fdf0f1; border-color: var(--danger-color); }
        #order-total { margin-top: calc(var(--spacing-unit) * 1.5); }
        #order-total p { text-align: right; font-size: 1.25em; font-weight: 600; margin: var(--spacing-unit) 0; }
        #order-total p strong { color: var(--success-color); font-size: 1.1em; font-weight: 700; margin-left: 8px; }
        #kitchen-summary { background-color: #f8f9fa; padding: var(--spacing-unit); border: 1px solid var(--medium-gray); border-radius: var(--border-radius); margin-top: var(--spacing-unit); margin-bottom: calc(var(--spacing-unit) * 1.5); }
        #kitchen-summary h3 { text-align: center; font-size: 1.2em; color: var(--text-color); margin-bottom: calc(var(--spacing-unit)*0.8); border-bottom: 1px solid var(--medium-gray); padding-bottom: 8px; }
        #kitchen-items-list { list-style: none; padding: 0; margin: 0; }
        #kitchen-items-list li { font-size: 1.1em; font-weight: 500; padding: 8px 5px; border-bottom: 1px dotted var(--medium-gray); }
        #kitchen-items-list li:last-child { border-bottom: none; }
        #kitchen-items-list li strong { font-weight: 700; margin-right: 10px; display: inline-block; min-width: 30px; text-align: right; }
        #order-notes-container { margin-top: var(--spacing-unit); margin-bottom: calc(var(--spacing-unit) * 1.5); }
        #order-notes-container label { display: block; margin-bottom: 8px; font-weight: 500; color: var(--dark-gray); font-size: 0.95em; }
        #order-notes { width: 100%; padding: 10px; border: 1px solid var(--medium-gray); border-radius: 5px; font-size: 0.95em; line-height: 1.5; resize: vertical; }
        #order-notes:focus-visible { outline: 2px solid var(--primary-color); outline-offset: 1px; border-color: var(--primary-color); }
        #finish-eating { width: 100%; padding: 14px; font-size: 1.15em; font-weight: 600; background-color: var(--primary-color); color: white; border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.15s ease, transform 0.1s ease; }
        #finish-eating:hover { background-color: var(--primary-darker); }
        #finish-eating:active { background-color: #004085; transform: scale(0.98); }
        #finish-eating:focus-visible { outline: 3px solid var(--primary-color); outline-offset: 2px; }
        #final-bill { background-color: var(--card-bg); padding: calc(var(--spacing-unit) * 1.8); border-radius: var(--border-radius); box-shadow: var(--card-shadow); margin-top: calc(var(--spacing-unit) * 2); border: 1px solid var(--medium-gray); }
        #final-bill h2 { text-align: center; font-size: 1.8em; }
        #final-bill ul { list-style: none; padding: 0; margin: 0 0 var(--spacing-unit) 0; border-bottom: 1px solid var(--medium-gray); padding-bottom: var(--spacing-unit); }
        #final-bill li { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px dotted var(--card-border-color); }
        #final-bill li:last-child { border-bottom: none; }
        #final-bill li span:first-child { flex-grow: 1; margin-right: var(--spacing-unit); line-height: 1.4; }
        #final-bill li span:last-child { font-weight: 600; min-width: 100px; text-align: right; color: var(--dark-gray); }
        #final-bill p#bill-total-line { text-align: right; font-size: 1.4em; font-weight: 700; margin-top: calc(var(--spacing-unit) * 1.5); margin-bottom: var(--spacing-unit); }
        #final-bill #bill-total { color: var(--success-color); font-size: 1.1em; margin-left: 10px; }
        #final-bill p#thank-you-line { text-align: center; font-size: 1.1em; font-weight: 500; color: var(--dark-gray); margin-top: calc(var(--spacing-unit) * 1.5); margin-bottom: calc(var(--spacing-unit) * 1.8); }
        #final-bill #new-order { display: block; width: 100%; padding: 12px; font-size: 1.1em; font-weight: 600; background-color: var(--dark-gray); color: white; border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.15s ease, transform 0.1s ease; }
        #final-bill #new-order:hover { background-color: #5a6268; }
        #final-bill #new-order:active { background-color: #545b62; transform: scale(0.98); }
        #final-bill #new-order:focus-visible { outline: 3px solid var(--dark-gray); outline-offset: 2px; }
        .hidden { display: none !important; }
        #view-order-float-button { position: fixed; bottom: 20px; right: 20px; z-index: 999; background-color: var(--float-button-bg); color: var(--float-button-text); border: none; border-radius: 50px; padding: 10px 15px; font-size: 0.9em; font-weight: 600; cursor: pointer; box-shadow: var(--float-button-shadow); display: flex; align-items: center; gap: 8px; transition: background-color 0.2s ease, transform 0.2s ease, opacity 0.3s ease; opacity: 1; }
        #view-order-float-button:hover { background-color: var(--float-button-hover-bg); transform: scale(1.05); }
        #view-order-float-button:active { transform: scale(1); }
        #view-order-float-button.hidden { opacity: 0; pointer-events: none; transform: scale(0.8); }
        #view-order-float-button .order-count { background-color: rgba(255, 255, 255, 0.2); padding: 2px 6px; border-radius: 10px; font-size: 0.9em; min-width: 20px; text-align: center; font-weight: bold; }
        #view-order-float-button svg { width: 20px; height: 20px; fill: currentColor; vertical-align: middle; }

        /* === MODAL CHUNG & C·∫¢I TI·∫æN MODAL CHI TI·∫æT === */
        .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--modal-overlay-bg); display: flex; align-items: center; justify-content: center; opacity: 0; visibility: hidden; transition: opacity 0.3s ease, visibility 0.3s ease; z-index: 1000; padding: var(--spacing-unit); }
        .modal-overlay.visible { opacity: 1; visibility: visible; }
        /* √Åp d·ª•ng cho c·∫£ info-modal v√† noodle-choice-modal (tr·ª´ nh·ªØng g√¨ ƒë∆∞·ª£c ghi ƒë√®) */
        .modal-content { background-color: var(--card-bg); padding: calc(var(--spacing-unit) * 1.8); border-radius: var(--border-radius); box-shadow: 0 5px 20px rgba(0,0,0,0.2); max-width: 550px; width: 95%; position: relative; transform: scale(0.95); transition: transform 0.3s ease; max-height: 90vh; /* TƒÉng chi·ªÅu cao t·ªëi ƒëa */ display: flex; flex-direction: column; }
        .modal-overlay.visible .modal-content { transform: scale(1); }
        .modal-close { position: absolute; top: 12px; right: 15px; background: none; border: none; font-size: 2.2em; line-height: 1; color: var(--medium-gray); cursor: pointer; padding: 0; transition: color 0.2s ease; z-index: 10; }
        .modal-close:hover { color: var(--dark-gray); }

        /* Styles ri√™ng cho Info Modal */
        #info-modal .modal-content { /* Gi·ªØ nguy√™n c√°c style ƒë√£ c√≥ n·∫øu c·∫ßn */ }
        #modal-item-image { display: block; width: 100%; max-height: 220px; /* Gi·∫£m chi·ªÅu cao ·∫£nh */ object-fit: cover; border-radius: calc(var(--border-radius) / 2); margin-bottom: var(--spacing-unit); background-color: #e9ecef; }
        .modal-section { margin-bottom: calc(var(--spacing-unit) * 1); }
        .modal-section:last-child { margin-bottom: 0; }
        #modal-item-name { font-size: 1.6em; font-weight: 700; margin-bottom: calc(var(--spacing-unit) * 0.3); color: var(--text-color); text-align: center; }
        #modal-item-price { font-size: 1.25em; font-weight: 600; color: var(--primary-color); text-align: center; margin-top: 0; }
        #modal-noodle-options { font-size: 0.9em; text-align: center; border-top: 1px solid var(--card-border-color); border-bottom: 1px solid var(--card-border-color); padding: calc(var(--spacing-unit)*0.8) 0; }
        #modal-noodle-options strong { display: block; font-weight: 600; margin-bottom: 5px; color: var(--dark-gray); }
        #modal-noodle-options ul { list-style: none; padding: 0; margin: 0; }
        #modal-noodle-options li { display: inline-block; margin: 0 8px; color: var(--text-color); }
        #modal-noodle-options li .noodle-opt-desc { font-size: 0.9em; color: var(--dark-gray); }
        #modal-item-description { font-size: 0.95em; line-height: 1.7; color: var(--dark-gray); margin-top: 0; flex-grow: 1; overflow-y: auto; padding-right: 10px; }

        /* Styles ri√™ng cho Noodle Choice Modal */
        #noodle-choice-modal .modal-content {
            max-width: 400px;
            /* Reset c√°c thu·ªôc t√≠nh b·ªã ·∫£nh h∆∞·ªüng b·ªüi style modal chung */
            display: block;
            flex-direction: unset;
            max-height: none; /* B·ªè gi·ªõi h·∫°n chi·ªÅu cao */
        }
        #noodle-choice-modal h4 { text-align: center; font-size: 1.3em; border-bottom: 1px solid var(--medium-gray); padding-bottom: 10px; margin-bottom: var(--spacing-unit); }
        .noodle-options { display: flex; /* Gi·ªØ flex cho c√°c options */ justify-content: space-around; gap: 10px; flex-wrap: wrap; }
        .noodle-option { text-align: center; /* CƒÉn gi·ªØa n√∫t trong div c·ªßa n√≥ */ margin-bottom: 5px; /* Th√™m kho·∫£ng c√°ch n·∫øu n√∫t qu√° d√†i v√† wrap */ }
        .noodle-option button {
            background-color: var(--light-gray); border: 1px solid var(--medium-gray);
            color: var(--primary-color); padding: 12px 18px; /* C√≥ th·ªÉ gi·∫£m padding ngang ch√∫t */
            border-radius: var(--border-radius); cursor: pointer; font-size: 1.0em; /* Gi·∫£m nh·∫π font size n·∫øu c·∫ßn */
            font-weight: 500; /* Gi·∫£m ƒë·ªô ƒë·∫≠m ch√∫t */
            transition: background-color 0.2s ease, border-color 0.2s ease, transform 0.1s ease;
            min-width: 90px; /* Gi·ªØ min-width */
            line-height: 1.4; /* Cho ph√©p ch·ªØ xu·ªëng d√≤ng d·ªÖ h∆°n */
            white-space: normal; /* Cho ph√©p ch·ªØ t·ª± xu·ªëng d√≤ng */
            text-align: center; /* CƒÉn gi·ªØa ch·ªØ trong n√∫t */
        }
        .noodle-option button:hover { background-color: #e9ecef; border-color: var(--dark-gray); }
        .noodle-option button:active { transform: scale(0.97); }
        .noodle-option button:focus-visible { outline: 2px solid var(--primary-color); outline-offset: 2px; }
        .noodle-desc { /* Class n√†y kh√¥ng c√≤n d√πng n·ªØa n·∫øu theo ph∆∞∆°ng √°n 3 */ display: none; }

        /* === RESPONSIVE === */
        @media (max-width: 992px) {
             #order-section { position: static; border: none; box-shadow: none; }
             .container { padding: var(--spacing-unit); }
             .container > h1 { font-size: 1.8em; }
             h2 { font-size: 1.4em; }
             .menu-category-title { font-size: 1.2em; padding: calc(var(--spacing-unit) * 0.6) var(--spacing-unit); }
             .modal-content { max-width: 90%; padding: calc(var(--spacing-unit) * 1.5); }
             .menu-category-items { grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); }
             .menu-item-card img { height: 250px; }
             #modal-item-name { font-size: 1.4em; }
             #modal-item-price { font-size: 1.15em; }
             #modal-noodle-options li { display: block; margin: 4px 0;}
             #modal-item-image { max-height: 220px; }
        }
        @media (max-width: 768px) {
             .menu-order-container { flex-direction: column; gap: var(--spacing-unit); }
             #order-section { width: 100%; margin-top: 0; border: 1px solid var(--medium-gray); box-shadow: var(--card-shadow); position: static; }
             .menu-category-items { grid-template-columns: 1fr; gap: var(--spacing-unit); }
             .menu-item-card img { height: 220px; }
             h3 { font-size: 1em; }
             .en-name { margin-right: 0.3em; }
             .vn-name { font-size: 0.85em; }
             .menu-item-info .price { font-size: 1.1em; }
             .add-to-order-button { padding: 10px; font-size: 0.95em; }
             .add-to-order-button.item-in-order { padding-left: 12px; padding-right: 8px;}
             .remove-from-menu { font-size: 1.2em; }
             #kitchen-summary { margin-top: var(--spacing-unit); margin-bottom: var(--spacing-unit); }
             #kitchen-items-list li { font-size: 1em; }
             .modal-content { padding: var(--spacing-unit); }
             h4 { font-size: 1.2em;}
             #modal-item-name { font-size: 1.3em; }
             #modal-item-price { font-size: 1.1em; }
             #modal-item-description { font-size: 0.9em; line-height: 1.6; }
             .modal-close { font-size: 2em; top: 5px; right: 10px;}
             /* Style cho noodle modal tr√™n mobile */
             #noodle-choice-modal .modal-content { /* K√≠ch th∆∞·ªõc gi·ªØ nguy√™n */ }
             .noodle-options { flex-direction: column; align-items: stretch; gap: 8px; }
             .noodle-option button { width: 100%; font-size: 1.0em; padding: 10px; /* Gi·∫£m padding ch√∫t */}
             /* --- */
             #view-order-float-button { bottom: 15px; right: 15px; padding: 8px 12px; font-size: 0.85em; }
             #view-order-float-button svg { width: 18px; height: 18px; }
             .info-icon { font-size: 0.7em; }
             #modal-item-image { max-height: 160px; }
             #modal-noodle-options { font-size: 0.85em; padding: calc(var(--spacing-unit)*0.6) 0; }
             #modal-noodle-options li { margin: 2px 0; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Our Menu / Th·ª±c ƒê∆°n</h1>
        <div class="menu-order-container">
            <section id="menu-section"><h2>Menu</h2><div id="menu"></div></section>
            <section id="order-section"><h2>Your Order / M√≥n ƒê√£ Ch·ªçn</h2><div id="order-summary">
                    <ul id="order-items"><li class="order-empty-message">Loading menu... / ƒêang t·∫£i th·ª±c ƒë∆°n...</li></ul>
                    <div id="kitchen-summary" class="hidden"><h3>Y√™u c·∫ßu b·∫øp</h3><ul id="kitchen-items-list"></ul></div>
                    <div id="order-notes-container" class="hidden"><label for="order-notes">Notes / Ghi ch√∫:</label><textarea id="order-notes" rows="3" placeholder="Any special requests? (e.g., no onions, less spicy) / Y√™u c·∫ßu ƒë·∫∑c bi·ªát? (vd: kh√¥ng h√†nh, √≠t cay)"></textarea></div>
                    <div id="order-total"><p>Total / T·ªïng c·ªông: <strong id="total-cost">0 VND</strong></p></div>
                    <button id="finish-eating" class="hidden">Finish Eating / Thanh To√°n</button>
            </div></section>
        </div>
        <div id="final-bill" class="hidden"><h2>Final Bill / H√≥a ƒê∆°n</h2><ul id="bill-items"></ul><p id="bill-total-line">Total Amount / T·ªïng Thanh To√°n: <strong id="bill-total">0 VND</strong></p><p id="thank-you-line">Thank you! / C·∫£m ∆°n!</p><button id="new-order">New Order / Order M·ªõi</button></div>
    </div>

    <div id="info-modal" class="modal-overlay hidden"> <div class="modal-content"> <button id="info-modal-close" class="modal-close" aria-label="ƒê√≥ng">√ó</button> <img id="modal-item-image" src="" alt="H√¨nh ·∫£nh m√≥n ƒÉn" loading="lazy" class="modal-section"> <h4 id="modal-item-name" class="modal-section">Item Name</h4> <p id="modal-item-price" class="modal-section"></p> <div id="modal-noodle-options" class="modal-section"></div> <div id="modal-item-description" class="modal-section">Description details...</div> </div> </div>

    <div id="noodle-choice-modal" class="modal-overlay hidden">
         <div class="modal-content noodle-choice-content">
             <button id="noodle-modal-close" class="modal-close" aria-label="ƒê√≥ng">√ó</button>
             <h4>Choose Noodle Type:</h4>
             <div class="noodle-options">
                 <div class="noodle-option">
                     <button data-noodle-type="Pho">Flat Rice Noodles (Pho)</button>
                     </div>
                 <div class="noodle-option">
                     <button data-noodle-type="Mi">Egg Noodles (Mi)</button>
                      </div>
                 <div class="noodle-option">
                     <button data-noodle-type="Mien">Glass Noodles (Mien)</button>
                      </div>
             </div>
         </div>
     </div>

     <button id="view-order-float-button" class="hidden" aria-label="Xem ƒë∆°n h√†ng"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17.218,2.268L22,4.947V20.73A.27.27,0,0,1,21.729,21L12,17.269,2.271,21A.27.27,0,0,1,2,20.731V4.947L6.782,2.268A.27.27,0,0,1,7.053,2h9.894A.27.27,0,0,1,17.218,2.268ZM12,15.731,21,19.469V5.82L16.947,3.5H7.053L3,5.82V19.469Z"/><path d="M8,8.5a1,1,0,0,1,1-1h6a1,1,0,0,1,0,2H9A1,1,0,0,1,8,8.5Z"/><path d="M8,12.5a1,1,0,0,1,1-1h6a1,1,0,0,1,0,2H9A1,1,0,0,1,8,12.5Z"/></svg><span class="order-count">0</span></button>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const noodleTypes = { Pho: { name: "Ph·ªü", vnName: "Ph·ªü", enName: "Pho", enDesc: "(Flat rice noodles)" }, Mi:  { name: "M√¨",  vnName: "M√¨",  enName: "Mi",  enDesc: "(Egg noodles)" }, Mien:{ name: "Mi·∫øn",vnName: "Mi·∫øn",enName: "Mien", enDesc: "(Glass noodles)" } };
            const placeholderImageUrl = 'https://placehold.co/600x400/EEE/31343C?text=M√≥n+ƒÇn&font=montserrat';
            const menuData = [ /* ... D·ªØ li·ªáu menu gi·ªØ nguy√™n ... */ { id: 'ga_nuoc', name: 'Chicken Noodle Soup (Ph·ªü/M√¨/Mi·∫øn G√† N∆∞·ªõc)', vietnameseName: 'G√† N∆∞·ªõc', price: 40000, image: 'https://inhat.vn/wp-content/uploads/2020/10/pho-ga-ngon-ha-noi-12.png', category: 'Ph·ªü, M√¨, Mi·∫øn / Noodles', noodleOptions: ['Pho', 'Mi', 'Mien'], description: 'Clear chicken broth simmered with spices, topped with boiled chicken slices or shreds, scallions, and fresh herbs. Served with your choice of noodles.' },{ id: 'ga_tron', name: 'Mixed Noodles with Chicken (Ph·ªü/M√¨/Mi·∫øn G√† Tr·ªôn)', vietnameseName: 'G√† Tr·ªôn', price: 45000, image: 'https://inhat.vn/wp-content/uploads/2020/10/pho-ga-ngon-ha-noi-4.jpg', category: 'Ph·ªü, M√¨, Mi·∫øn / Noodles', noodleOptions: ['Pho', 'Mi', 'Mien'], description: 'Your choice of noodles mixed with shredded chicken, roasted peanuts, crispy fried shallots, fresh herbs, and a tangy sweet & sour dressing. Served without broth.', isSpicy: true },{ id: 'ga_dui_nuoc', name: 'Chicken Thigh Noodle Soup (Ph·ªü/M√¨/Mi·∫øn G√† ƒê√πi N∆∞·ªõc)', vietnameseName: 'G√† ƒê√πi N∆∞·ªõc', price: 45000, image: 'https://inoxvietnam.vn/wp-content/uploads/2020/10/cach-nau-pho-ga-cong-thuc-nau-pho-ga-dam-da.jpg', category: 'Ph·ªü, M√¨, Mi·∫øn / Noodles', noodleOptions: ['Pho', 'Mi', 'Mien'], description: 'Flavorful noodle soup featuring tender, juicy chicken thigh meat in a clear chicken broth, scallions and herbs. Served with your choice of noodles.' },{ id: 'ga_dui_tron', name: 'Mixed Noodles with Chicken Thigh (Ph·ªü/M√¨/Mi·∫øn G√† ƒê√πi Tr·ªôn)', vietnameseName: 'G√† ƒê√πi Tr·ªôn', price: 50000, image: 'https://img-global.cpcdn.com/recipes/f4f38d29faf2d94f/1360x964cq70/ph%E1%BB%9F-ga-tr%E1%BB%99n-recipe-main-photo.webp', category: 'Ph·ªü, M√¨, Mi·∫øn / Noodles', noodleOptions: ['Pho', 'Mi', 'Mien'], description: 'A refreshing mix of your choice of noodles with succulent chicken thigh meat, roasted peanuts, fried shallots, herbs, and a sweet & sour dressing.', isSpicy: true },{ id: 'bo_nuoc', name: 'Beef Noodle Soup (Ph·ªü/M√¨/Mi·∫øn B√≤ N∆∞·ªõc)', vietnameseName: 'B√≤ N∆∞·ªõc', price: 40000, image: 'https://cdn.eva.vn/upload/3-2020/images/2020-09-19/1600510801-photo-1-1600006283562691307317.jpg', category: 'Ph·ªü, M√¨, Mi·∫øn / Noodles', noodleOptions: ['Pho', 'Mi', 'Mien'], description: 'Rich beef broth simmered for hours, served with your choice of noodles and thinly sliced beef (select rare, well-done, flank, brisket, or mixed), onions, and herbs.' },{ id: 'bo_tron', name: 'Mixed Noodles with Beef (Ph·ªü/M√¨/Mi·∫øn B√≤ Tr·ªôn)', vietnameseName: 'B√≤ Tr·ªôn', price: 45000, image: 'https://cdn.tgdd.vn/Files/2017/04/20/974364/cach-lam-pho-tron-thit-bo-thom-ngon-la-mieng-10_760x833.jpg', category: 'Ph·ªü, M√¨, Mi·∫øn / Noodles', noodleOptions: ['Pho', 'Mi', 'Mien'], description: 'Your choice of noodles tossed with savory stir-fried beef, roasted peanuts, fried shallots, fresh herbs, and a balanced sweet & sour dressing.', isSpicy: true },{ id: 'ga_bo_nuoc', name: 'Chicken & Beef Noodle Soup (Ph·ªü/M√¨/Mi·∫øn G√† B√≤ N∆∞·ªõc)', vietnameseName: 'G√† B√≤ N∆∞·ªõc', price: 45000, image: placeholderImageUrl, category: 'Ph·ªü, M√¨, Mi·∫øn / Noodles', noodleOptions: ['Pho', 'Mi', 'Mien'], description: 'A hearty combination of both tender chicken and sliced beef in our signature broth, served with your choice of noodles, onions, and herbs.' },{ id: 'ga_bo_tron', name: 'Mixed Noodles with Chicken & Beef (Ph·ªü/M√¨/Mi·∫øn G√† B√≤ Tr·ªôn)', vietnameseName: 'G√† B√≤ Tr·ªôn', price: 50000, image: placeholderImageUrl, category: 'Ph·ªü, M√¨, Mi·∫øn / Noodles', noodleOptions: ['Pho', 'Mi', 'Mien'], description: 'The best of both worlds: mixed noodles featuring both shredded chicken and stir-fried beef, combined with peanuts, shallots, herbs, and dressing. Choose noodle type your noodle type.', isSpicy: true },{ id: 'mi_xao_bo', name: 'Stir-fried Noodles with Beef (M√¨ x√†o B√≤)', vietnameseName: 'M√¨ x√†o B√≤', price: 45000, image: 'https://nghebep.com/wp-content/uploads/2017/10/mon-mi-xao-bo.jpg', category: 'M√¨ X√†o / Stir-fried Noodles', description: 'Classic stir-fried egg noodles with tender beef slices, bok choy, onions, carrots, and savory sauce.', isSpicy: true },{ id: 'mi_xao_tim', name: 'Stir-fried Noodles with Pork Heart (M√¨ x√†o Tim)', vietnameseName: 'M√¨ x√†o Tim', price: 45000, image: 'https://navicdn.com/nauankhongkho.com/wp-content/uploads/2016/05/143210948829-768x576.jpg', category: 'M√¨ X√†o / Stir-fried Noodles', description: 'Stir-fried egg noodles featuring carefully prepared, thinly sliced pork heart mixed with assorted vegetables.', isSpicy: true },{ id: 'mi_xao_bau_duc', name: 'Stir-fried Noodles with Pork Kidney (M√¨ x√†o B·∫ßu d·ª•c)', vietnameseName: 'M√¨ x√†o B·∫ßu d·ª•c', price: 40000, image: 'https://kenh14cdn.com/203336854389633024/2025/2/22/dsc00215-17401680022842135927921-1740186568658-17401865703781702331045.jpg', category: 'M√¨ X√†o / Stir-fried Noodles', description: 'Egg noodles stir-fried with meticulously cleaned and sliced pork kidney and various fresh vegetables.', isSpicy: true },{ id: 'mi_xao_tim_bau_duc', name: 'Stir-fried Noodles with Pork Heart & Kidney (M√¨ x√†o Tim b·∫ßu d·ª•c)', vietnameseName: 'M√¨ x√†o Tim b·∫ßu d·ª•c', price: 50000, image: 'https://bepphuongdong.com/images/2018/223/tim-cat-xao-thap-cam(1).jpg', category: 'M√¨ X√†o / Stir-fried Noodles', description: 'A combination stir-fry featuring both sliced pork heart and kidney, served over egg noodles with vegetables.', isSpicy: true },{ id: 'chao_ga', name: 'Chicken Congee (Ch√°o G√†)', vietnameseName: 'Ch√°o G√†', price: 40000, image: placeholderImageUrl, category: 'Ch√°o / Congee', description: 'Comforting rice porridge slow-cooked in chicken broth, served topped with shredded chicken, scallions, black pepper, and optional herbs like perilla.' },{ id: 'chao_tim', name: 'Pork Heart Congee (Ch√°o Tim)', vietnameseName: 'Ch√°o Tim', price: 40000, image: 'https://static.vinwonders.com/production/chao-tim-cat-ha-noi-5.jpg', category: 'Ch√°o / Congee', description: 'Smooth rice porridge cooked with tender, thinly sliced pork heart.' },{ id: 'chao_tim_thit_bam', name: 'Pork Heart & Minced Meat Congee (Ch√°o Tim th·ªãt bƒÉm)', vietnameseName: 'Ch√°o Tim th·ªãt bƒÉm', price: 45000, image: placeholderImageUrl, category: 'Ch√°o / Congee', description: 'A richer version of congee combining both sliced pork heart and savory minced pork in rice porridge.' },{ id: 'chao_thit_bam', name: 'Minced Meat Congee (Ch√°o Th·ªãt bƒÉm)', vietnameseName: 'Ch√°o Th·ªãt bƒÉm', price: 35000, image: placeholderImageUrl, category: 'Ch√°o / Congee', description: 'Simple yet satisfying rice porridge cooked with seasoned minced pork, typically garnished with scallions and pepper.' },{ id: 'chao_bau_duc', name: 'Pork Kidney Congee (Ch√°o B·∫ßu d·ª•c)', vietnameseName: 'Ch√°o B·∫ßu d·ª•c', price: 40000, image: placeholderImageUrl, category: 'Ch√°o / Congee', description: 'Rice porridge featuring thinly sliced, well-cleaned pork kidney.' },{ id: 'chao_tim_bau_duc', name: 'Pork Heart & Kidney Congee (Ch√°o Tim b·∫ßu d·ª•c)', vietnameseName: 'Ch√°o Tim b·∫ßu d·ª•c', price: 45000, image: placeholderImageUrl, category: 'Ch√°o / Congee', description: 'A hearty rice porridge combining both sliced pork heart and kidney.' },{ id: 'tra_da', name: 'Iced Tea (Tr√† ƒë√°)', vietnameseName: 'Tr√† ƒë√°', price: 5000, image: 'https://i-ngoisao.vnecdn.net/2024/06/20/Tra-Da-Ha-Noi-6-8716-1718883996.jpg', category: 'ƒê·ªì u·ªëng / Beverages', description: 'Refreshing Vietnamese-style plain iced tea, usually brewed from green or black tea.' },{ id: 'tra_chanh', name: 'Lemon Iced Tea (Tr√† chanh)', vietnameseName: 'Tr√† chanh', price: 15000, image: 'https://bizweb.dktcdn.net/100/421/036/files/cach-lam-tra-chanh-kim-quat-3a3bbf56-6659-4db6-bf54-d2bbbfab21cf.jpg?v=1638608737566', category: 'ƒê·ªì u·ªëng / Beverages', description: 'Classic iced tea sweetened and mixed with fresh lemon juice.' },{ id: 'tra_quat', name: 'Kumquat Iced Tea (Tr√† qu·∫•t)', vietnameseName: 'Tr√† qu·∫•t', price: 15000, image: 'https://hunufa.vn/wp-content/uploads/2025/02/ly-tra-tac-khong-lo-1.webp', category: 'ƒê·ªì u·ªëng / Beverages', description: 'Iced tea infused with the unique sweet, sour, and aromatic flavor of kumquat juice.' },{ id: 'tra_chanh_leo', name: 'Passion Fruit Iced Tea (Tr√† chanh leo)', vietnameseName: 'Tr√† chanh leo', price: 15000, image: 'https://horecavn.com/wp-content/uploads/2024/05/luc-tra-chanh-day-ly-500ml_20240527104903.png', category: 'ƒê·ªì u·ªëng / Beverages', description: 'Tropical iced tea blended with tangy passion fruit juice and sweetener.' },{ id: 'nuoc_ngot', name: 'Soft Drink / Soda (N∆∞·ªõc ng·ªçt)', vietnameseName: 'N∆∞·ªõc ng·ªçt', price: 15000, image: 'https://bizweb.dktcdn.net/100/436/111/products/coca-2.png?v=1703986211787', category: 'ƒê·ªì u·ªëng / Beverages', description: 'Selection of popular canned or bottled soft drinks (e.g., Coke, Pepsi, Sprite, 7up).' },{ id: 'bo_huc', name: 'Energy Drink (B√≤ h√∫c)', vietnameseName: 'B√≤ h√∫c', price: 15000, image: 'https://cdn-images.kiotviet.vn/batraifarm/96ae25e2eb294e99b8823adf2d3d75ad.jpg', category: 'ƒê·ªì u·ªëng / Beverages', description: 'Canned energy drink like Red Bull or similar local brands.' },];
            let currentOrder = {}; let tempOrderItem = null;
            const menuDiv = document.getElementById('menu'); const orderItemsUl = document.getElementById('order-items'); const totalCostSpan = document.getElementById('total-cost'); const finishEatingButton = document.getElementById('finish-eating'); const finalBillDiv = document.getElementById('final-bill'); const billItemsUl = document.getElementById('bill-items'); const billTotalSpan = document.getElementById('bill-total'); const newOrderButton = document.getElementById('new-order'); const menuSection = document.getElementById('menu-section'); const orderSection = document.getElementById('order-section'); const kitchenSummaryDiv = document.getElementById('kitchen-summary'); const kitchenItemsListUl = document.getElementById('kitchen-items-list'); const orderNotesContainer = document.getElementById('order-notes-container'); const orderNotesTextarea = document.getElementById('order-notes'); const infoModal = document.getElementById('info-modal'); const infoModalContent = infoModal?.querySelector('.modal-content'); const infoModalCloseButton = document.getElementById('info-modal-close'); const modalItemName = document.getElementById('modal-item-name'); const modalItemDescription = document.getElementById('modal-item-description'); const modalItemImage = document.getElementById('modal-item-image'); const modalItemPrice = document.getElementById('modal-item-price'); const modalNoodleOptionsDiv = document.getElementById('modal-noodle-options'); const noodleChoiceModal = document.getElementById('noodle-choice-modal'); const noodleChoiceModalContent = noodleChoiceModal?.querySelector('.modal-content'); const noodleModalCloseButton = document.getElementById('noodle-modal-close'); const noodleOptionsContainer = noodleChoiceModal?.querySelector('.noodle-options'); const viewOrderFloatButton = document.getElementById('view-order-float-button'); const viewOrderCountSpan = viewOrderFloatButton?.querySelector('.order-count');
            function formatCurrency(amount) { return amount.toLocaleString('vi-VN') + ' VND'; }
            function displayMenu() { /* ... Gi·ªØ nguy√™n ... */ if (!menuDiv) return; menuDiv.innerHTML = ''; const groupedMenu = menuData.reduce((acc, item) => { item.description = item.description || ''; const category = item.category || 'Kh√°c / Others'; if (!acc[category]) acc[category] = []; acc[category].push(item); return acc; }, {}); for (const categoryName in groupedMenu) { const categoryTitle = document.createElement('h2'); categoryTitle.classList.add('menu-category-title'); categoryTitle.textContent = categoryName; menuDiv.appendChild(categoryTitle); const categoryItemsContainer = document.createElement('div'); categoryItemsContainer.classList.add('menu-category-items'); menuDiv.appendChild(categoryItemsContainer); groupedMenu[categoryName].forEach(item => { const card = document.createElement('div'); card.classList.add('menu-item-card'); card.dataset.id = item.id; const imgSrc = item.image || placeholderImageUrl; const imgAlt = item.name; const imgHTML = `<img src="${imgSrc}" alt="${imgAlt}" loading="lazy" onerror="this.onerror=null; this.src='${placeholderImageUrl}'; console.warn('Failed to load image, using placeholder: ${imgSrc}')">`; let enName = item.name; let vnName = ''; const nameParts = item.name.split(' ('); if (nameParts.length > 1) { enName = nameParts[0].trim(); vnName = '(' + nameParts[1]; } const spicyIconHTML = item.isSpicy ? '<span class="spicy-icon" aria-label="Spicy">üå∂Ô∏è</span>' : ''; let noodleInfoHTML = ''; if (item.noodleOptions && item.noodleOptions.length > 0) { noodleInfoHTML = `<span class="noodle-choice-indicator">(Choose noodle type)</span><small class="noodle-choice-explanation">(Choice required upon adding)</small>`; } const infoButtonHTML = `<button class="info-icon" data-id="${item.id}" title="Chi ti·∫øt m√≥n ƒÉn" aria-label="Chi ti·∫øt m√≥n ${enName}">Chi ti·∫øt</button>`; card.innerHTML = `${imgHTML}<div class="menu-item-info"><div class="menu-item-name-wrapper"><h3><span class="en-name">${enName}</span>${vnName ? `<span class="vn-name">${vnName}</span>` : ''}${spicyIconHTML}</h3>${infoButtonHTML}</div><div class="menu-item-details"><span class="price">${formatCurrency(item.price)}</span>${noodleInfoHTML}</div><div class="quantity-selector"><button class="qty-decrease" data-id="${item.id}" aria-label="Decrease quantity">-</button><input type="number" class="qty-input" value="1" min="1" data-id="${item.id}" aria-label="Quantity"><button class="qty-increase" data-id="${item.id}" aria-label="Increase quantity">+</button></div><button class="add-to-order-button" data-id="${item.id}" data-name="${item.name}" data-price="${item.price}">Add to Order</button></div>`; categoryItemsContainer.appendChild(card); }); } }
            function updateOrderSummary() { /* ... Gi·ªØ nguy√™n ... */ if (!orderItemsUl || !kitchenItemsListUl || !kitchenSummaryDiv || !totalCostSpan || !orderNotesContainer || !finishEatingButton || !viewOrderFloatButton || !viewOrderCountSpan) { console.error("Missing one or more order summary/float button elements."); return; } orderItemsUl.innerHTML = ''; kitchenItemsListUl.innerHTML = ''; let total = 0; let itemCount = 0; let distinctItemCount = 0; const sortedItemIds = Object.keys(currentOrder).sort(); sortedItemIds.forEach(orderItemId => { const item = currentOrder[orderItemId]; if (item.quantity > 0) { itemCount += item.quantity; distinctItemCount++; const listItem = document.createElement('li'); const displayName = item.specificName || item.name; listItem.innerHTML = `<span>${displayName}</span><div class="order-qty-controls"><button class="order-decrease-qty" data-id="${orderItemId}" aria-label="Decrease quantity">-</button><span class="quantity" aria-label="Current quantity">${item.quantity}</span><button class="order-increase-qty" data-id="${orderItemId}" aria-label="Increase quantity">+</button></div><span class="item-total-price">${formatCurrency(item.price * item.quantity)}</span><button class="remove-item" data-id="${orderItemId}" aria-label="Remove item">X</button>`; orderItemsUl.appendChild(listItem); total += item.price * item.quantity; const kitchenListItem = document.createElement('li'); const vietnameseName = item.specificVietnameseName || item.vietnameseName || item.name; kitchenListItem.innerHTML = `<strong>${item.quantity}</strong> x ${vietnameseName}`; kitchenItemsListUl.appendChild(kitchenListItem); } else { delete currentOrder[orderItemId]; } }); totalCostSpan.textContent = formatCurrency(total); const isEmpty = distinctItemCount === 0; finishEatingButton.classList.toggle('hidden', isEmpty); kitchenSummaryDiv.classList.toggle('hidden', isEmpty); orderNotesContainer.classList.toggle('hidden', isEmpty); if (isEmpty) { viewOrderFloatButton.classList.add('hidden'); } else { viewOrderFloatButton.classList.remove('hidden'); viewOrderCountSpan.textContent = distinctItemCount; } const existingEmptyMsg = orderItemsUl.querySelector('.order-empty-message'); if (isEmpty && !existingEmptyMsg) { const emptyMsg = document.createElement('li'); emptyMsg.classList.add('order-empty-message'); emptyMsg.textContent = 'Your order is empty / Ch∆∞a ch·ªçn m√≥n n√†o'; orderItemsUl.appendChild(emptyMsg); } else if (!isEmpty && existingEmptyMsg) { existingEmptyMsg.remove(); } if (menuDiv) { const allMenuCards = menuDiv.querySelectorAll('.menu-item-card'); allMenuCards.forEach(card => { const baseItemId = card.dataset.id; const addButton = card.querySelector('.add-to-order-button'); if (addButton) { let isInOrder = !!currentOrder[baseItemId]; if (!isInOrder) { isInOrder = Object.keys(currentOrder).some(orderKey => orderKey.startsWith(baseItemId + '_') && currentOrder[orderKey].quantity > 0); } addButton.classList.toggle('item-in-order', isInOrder); if (isInOrder) { addButton.innerHTML = `<span>In Cart ‚úì</span><span class="remove-from-menu" data-remove-id="${baseItemId}" title="Remove all from cart" aria-label="Remove all ${addButton.dataset.name} from cart">‚úñ</span>`; } else { addButton.innerHTML = 'Add to Order'; } } }); } }
            function showConfirmation(buttonElement) { /* ... Gi·ªØ nguy√™n ... */ const parentInfo = buttonElement.closest('.menu-item-info'); if (!parentInfo) return; const existingConfirmation = parentInfo.querySelector('.add-confirmation'); if (existingConfirmation) existingConfirmation.remove(); const confirmation = document.createElement('span'); confirmation.classList.add('add-confirmation'); confirmation.textContent = '‚úì Added!'; parentInfo.appendChild(confirmation); requestAnimationFrame(() => { requestAnimationFrame(() => { confirmation.classList.add('show'); }); }); setTimeout(() => { confirmation.classList.remove('show'); setTimeout(() => { if(confirmation.parentNode) confirmation.remove(); }, 400); }, 1500); }
            function getVariationDetails(baseItemId, baseName, baseVnName, noodleTypeKey) { /* ... Gi·ªØ nguy√™n ... */ const noodleInfo = noodleTypes[noodleTypeKey]; if (!noodleInfo) return null; const specificId = `${baseItemId}_${noodleTypeKey.toLowerCase()}`; const specificVietnameseName = `${noodleInfo.vnName} ${baseVnName || ''}`.trim(); const baseEnNameMatch = baseName.match(/^(.*?)\s*\(/); const baseEnName = baseEnNameMatch ? baseEnNameMatch[1].trim() : baseName; const specificName = `${baseEnName} ${noodleInfo.name} (${specificVietnameseName})`; return { id: specificId, name: specificName, vietnameseName: specificVietnameseName }; }
            function openInfoModal(itemId) { if (!infoModal || !modalItemName || !modalItemDescription || !modalItemImage || !modalItemPrice || !modalNoodleOptionsDiv) { console.error("Info modal elements not found!"); return; } const itemData = menuData.find(item => item.id === itemId); if (itemData) { const name = itemData.name; const description = itemData.description || 'No description available.'; const price = itemData.price; const imageUrl = itemData.image || placeholderImageUrl; let englishName = name; const nameParts = name.split(' ('); if (nameParts.length > 1) { englishName = nameParts[0].trim(); } modalItemName.textContent = englishName; modalItemDescription.innerHTML = description.replace(/\n/g, '<br>'); modalItemPrice.textContent = formatCurrency(price); modalItemImage.src = imageUrl; modalItemImage.alt = englishName; if (itemData.noodleOptions && itemData.noodleOptions.length > 0) { let noodleOptionsHTML = '<strong>Noodle Options:</strong><ul>'; itemData.noodleOptions.forEach(key => { const noodleInfo = noodleTypes[key]; if (noodleInfo) { noodleOptionsHTML += `<li>${noodleInfo.enName} <span class="noodle-opt-desc">${noodleInfo.enDesc}</span></li>`; } }); noodleOptionsHTML += '</ul>'; modalNoodleOptionsDiv.innerHTML = noodleOptionsHTML; modalNoodleOptionsDiv.classList.remove('hidden'); } else { modalNoodleOptionsDiv.innerHTML = ''; modalNoodleOptionsDiv.classList.add('hidden'); } infoModal.classList.remove('hidden'); requestAnimationFrame(() => { infoModal.classList.add('visible'); document.body.classList.add('modal-open'); modalItemDescription.scrollTop = 0; }); } else { console.warn("Item data not found for ID:", itemId); modalItemName.textContent = "Error"; modalItemImage.src = placeholderImageUrl; modalItemImage.alt = "Error loading item"; modalItemPrice.textContent = ""; modalNoodleOptionsDiv.innerHTML = ''; modalNoodleOptionsDiv.classList.add('hidden'); modalItemDescription.innerHTML = "Item details could not be loaded."; infoModal.classList.remove('hidden'); requestAnimationFrame(() => { infoModal.classList.add('visible'); document.body.classList.add('modal-open'); }); } }
            function closeInfoModal() { /* ... Gi·ªØ nguy√™n ... */ if (!infoModal) return; infoModal.classList.remove('visible'); document.body.classList.remove('modal-open'); setTimeout(() => { infoModal.classList.add('hidden'); }, 300); }
            function openNoodleChoiceModal(itemId, quantity, originalButton) { /* ... Gi·ªØ nguy√™n ... */ if (!noodleChoiceModal || !noodleOptionsContainer) return; const itemData = menuData.find(item => item.id === itemId); if (!itemData || !itemData.noodleOptions) return; tempOrderItem = { baseItemId: itemId, baseName: itemData.name, baseVnName: itemData.vietnameseName, price: itemData.price, quantity: quantity, originalButton: originalButton, description: itemData.description || '' }; noodleChoiceModal.classList.remove('hidden'); requestAnimationFrame(() => { noodleChoiceModal.classList.add('visible'); document.body.classList.add('modal-open'); }); }
            function closeNoodleChoiceModal() { /* ... Gi·ªØ nguy√™n ... */ if (!noodleChoiceModal) return; noodleChoiceModal.classList.remove('visible'); document.body.classList.remove('modal-open'); setTimeout(() => { noodleChoiceModal.classList.add('hidden'); }, 300); tempOrderItem = null; }
            document.body.addEventListener('click', (event) => { /* ... Gi·ªØ nguy√™n ... */ const target = event.target; const infoButton = target.closest('.info-icon'); if (infoButton) { const infoItemId = infoButton.dataset.id; if(infoItemId) { openInfoModal(infoItemId); return; } } if (target === infoModalCloseButton || (target === infoModal && !infoModalContent?.contains(target))) { closeInfoModal(); return; } if (target === noodleModalCloseButton || (target === noodleChoiceModal && !noodleChoiceModalContent?.contains(target))) { closeNoodleChoiceModal(); return; } const noodleButton = target.closest('.noodle-option button'); if (noodleButton) { const noodleTypeKey = noodleButton.dataset.noodleType; if (tempOrderItem && noodleTypeKey) { const variationDetails = getVariationDetails(tempOrderItem.baseItemId, tempOrderItem.baseName, tempOrderItem.baseVnName, noodleTypeKey); if (variationDetails) { const { id: specificId, name: specificName, vietnameseName: specificVietnameseName } = variationDetails; if (currentOrder[specificId]) { currentOrder[specificId].quantity += tempOrderItem.quantity; } else { currentOrder[specificId] = { baseId: tempOrderItem.baseItemId, baseName: tempOrderItem.baseName, baseVietnameseName: tempOrderItem.baseVnName, name: specificName, vietnameseName: specificVietnameseName, price: tempOrderItem.price, quantity: tempOrderItem.quantity, description: tempOrderItem.description }; } updateOrderSummary(); showConfirmation(tempOrderItem.originalButton); } closeNoodleChoiceModal(); } return; } if (target.matches('.remove-from-menu')) { const baseItemIdToRemove = target.dataset.removeId; if (baseItemIdToRemove) { Object.keys(currentOrder).forEach(orderKey => { if (orderKey === baseItemIdToRemove || orderKey.startsWith(baseItemIdToRemove + '_')) { delete currentOrder[orderKey]; } }); updateOrderSummary(); const card = target.closest('.menu-item-card'); const input = card?.querySelector('.qty-input'); if(input) input.value = 1; } return; } const card = target.closest('.menu-item-card'); const orderItemLi = target.closest('#order-items li'); if (card) { const itemId = card.dataset.id; const input = card.querySelector(`.qty-input[data-id="${itemId}"]`); let currentVal = input ? parseInt(input.value) : 1; if (isNaN(currentVal) || currentVal < 1) currentVal = 1; if (target.classList.contains('qty-decrease')) { if (currentVal > 1 && input) input.value = currentVal - 1; } else if (target.classList.contains('qty-increase')) { if (input) input.value = currentVal + 1; } else if (target.classList.contains('add-to-order-button') && !target.classList.contains('item-in-order')) { const quantityToAdd = input ? parseInt(input.value) : 1; const itemData = menuData.find(item => item.id === itemId); if (itemData && quantityToAdd > 0) { if (itemData.noodleOptions && itemData.noodleOptions.length > 0) { openNoodleChoiceModal(itemId, quantityToAdd, target); } else { const price = itemData.price; if (!isNaN(price)) { if (currentOrder[itemId]) { currentOrder[itemId].quantity += quantityToAdd; } else { currentOrder[itemId] = { name: itemData.name, vietnameseName: itemData.vietnameseName, price: price, quantity: quantityToAdd, description: itemData.description || '' }; } if (input) input.value = 1; updateOrderSummary(); showConfirmation(target); } } } } } else if (orderItemLi) { const orderItemId = target.closest('[data-id]')?.dataset.id; if (!orderItemId || !currentOrder[orderItemId]) return; if (target.classList.contains('order-decrease-qty')) { currentOrder[orderItemId].quantity--; if (currentOrder[orderItemId].quantity <= 0) { delete currentOrder[orderItemId]; } updateOrderSummary(); } else if (target.classList.contains('order-increase-qty')) { currentOrder[orderItemId].quantity++; updateOrderSummary(); } else if (target.classList.contains('remove-item')) { delete currentOrder[orderItemId]; updateOrderSummary(); } } else if (target.id === 'finish-eating') { handleFinishEating(); } else if (target.id === 'new-order') { handleNewOrder(); } });
            if (viewOrderFloatButton) { /* ... Gi·ªØ nguy√™n ... */ viewOrderFloatButton.addEventListener('click', () => { const orderSectionElement = document.getElementById('order-section'); if (orderSectionElement) { orderSectionElement.scrollIntoView({ behavior: 'smooth', block: 'start' }); } }); }
            document.addEventListener('keydown', (event) => { /* ... Gi·ªØ nguy√™n ... */ if (event.key === 'Escape') { if (infoModal?.classList.contains('visible')) closeInfoModal(); if (noodleChoiceModal?.classList.contains('visible')) closeNoodleChoiceModal(); } });
            document.body.addEventListener('change', (event) => { /* ... Gi·ªØ nguy√™n ... */ const target = event.target; if (target.classList.contains('qty-input')) { let value = parseInt(target.value); if (isNaN(value) || value < 1) { target.value = 1; } } });
            function handleFinishEating() { /* ... Gi·ªØ nguy√™n ... */ if (!menuSection || !orderSection || !finalBillDiv || !billItemsUl || !billTotalSpan) return; menuSection.classList.add('hidden'); orderSection.classList.add('hidden'); finalBillDiv.classList.remove('hidden'); window.scrollTo({ top: 0, behavior: 'smooth' }); billItemsUl.innerHTML = ''; let billTotal = 0; const sortedItemIds = Object.keys(currentOrder).sort(); sortedItemIds.forEach(orderItemId => { const item = currentOrder[orderItemId]; if (item.quantity > 0) { const billListItem = document.createElement('li'); const displayName = item.name; billListItem.innerHTML = `<span>${item.quantity} x ${displayName}</span><span>${formatCurrency(item.price * item.quantity)}</span>`; billItemsUl.appendChild(billListItem); billTotal += item.price * item.quantity; } }); if(billTotalSpan) billTotalSpan.textContent = formatCurrency(billTotal); }
            function handleNewOrder() { /* ... Gi·ªØ nguy√™n ... */ if (!finalBillDiv || !menuSection || !orderSection) return; currentOrder = {}; finalBillDiv.classList.add('hidden'); menuSection.classList.remove('hidden'); orderSection.classList.remove('hidden'); const qtyInputs = document.querySelectorAll('.qty-input'); if (qtyInputs.length > 0) { qtyInputs.forEach(input => input.value = 1); } if(orderNotesTextarea) orderNotesTextarea.value = ''; updateOrderSummary(); window.scrollTo({ top: 0, behavior: 'smooth' }); }
            function initializeApp() { /* ... Gi·ªØ nguy√™n ... */ const essentialElements = [menuDiv, orderItemsUl, totalCostSpan, finishEatingButton, finalBillDiv, billItemsUl, billTotalSpan, newOrderButton, menuSection, orderSection, kitchenSummaryDiv, kitchenItemsListUl, orderNotesContainer, orderNotesTextarea, infoModal, modalItemName, modalItemDescription, modalItemImage, modalItemPrice, modalNoodleOptionsDiv, infoModalCloseButton, noodleChoiceModal, noodleModalCloseButton, noodleOptionsContainer, viewOrderFloatButton, viewOrderCountSpan]; let allElementsExist = true; for (const el of essentialElements) { if (!el) { console.error("Initialization failed: Essential HTML element is missing. Check IDs in HTML and JS.", el); allElementsExist = false; break; } } if (allElementsExist) { try { displayMenu(); updateOrderSummary(); } catch (error) { console.error("Error during initialization:", error); const container = document.querySelector('.container'); if(container) container.innerHTML = "<h1>L·ªói t·∫£i trang. Vui l√≤ng th·ª≠ l·∫°i. (Error loading page. Please try again.)</h1><p>Details in console.</p>"; } } else { const container = document.querySelector('.container'); if(container) container.innerHTML = "<h1>L·ªói t·∫£i trang. Vui l√≤ng th·ª≠ l·∫°i. (Error loading page. Please try again.)</h1><p>Essential element missing. Check console.</p>"; } }

            initializeApp();
        });
    </script>
</body>
</html>
